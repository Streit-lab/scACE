#!/usr/bin/env nextflow

singularity {
  enabled = true
  autoMounts = true
  docker.enabled = false
}

singularity.cacheDir = '/nemo/lab/briscoej/working/thierya/singularity'

params {
  max_memory      = 224.GB
  max_cpus        = 32
  max_time        = 100.h

  // Max hmem queue parameters
  max_hmem_cpus   = 96
  max_hmem_memory = 1500.GB
  max_hmem_time   = 72.h

  // Process-specific resource requirements
  withLabel:process_low {
    cpus = { check_max( 2 * task.attempt, 'cpus' ) }
    memory = { check_max( 4.GB * task.attempt, 'memory' ) }
    time = { check_max( 6.h * task.attempt, 'time' ) }
  }
  withLabel:process_medium {
    cpus = { check_max( 6 * task.attempt, 'cpus' ) }
    memory = { check_max( 8.GB * task.attempt, 'memory' ) }
    time = { check_max( 8.h * task.attempt, 'time' ) }
  }
  withLabel:process_high {
    cpus = { check_max( 12 * task.attempt, 'cpus' ) }
    memory = { check_max( 72.GB * task.attempt, 'memory' ) }
    time = { check_max( 16.h * task.attempt, 'time' ) }
  }

  append_outdir   = false // Append timestamp to results folder
  tracedir        = "${params.outdir}/_pipeline_info"

  fasta           = "/nemo/lab/briscoej/working/thierya/genomes/galgal6/Gallus_gallus.GRCg6a.dna.toplevel.fa"
}
