library(shiny)
library(bs4Dash)
library(data.table)
library(tidyverse)
library(viridis)
library(mgcv)
library(patchwork)
library(Seurat)
library(ComplexHeatmap)
#library(shinycssloaders)

source('./custom_functions.R')

# Don't know what this does
options(scipen = 1)
options(digits = 2)

##########################################################################
###################       Read in data      ##############################

# Read in normalised matrix of SEACells x all peaks (temp with only 100 peaks)
SEACells_peak_matrix <- fread('../output/Rshiny_input_SEACells_matrix.csv')
SEACells_IDs <- SEACells_peak_matrix$V1
table(duplicated(SEACells_IDs))
SEACells_peak_matrix <- SEACells_peak_matrix[,-1]
SEACells_peak_matrix <- as.matrix(sapply(SEACells_peak_matrix, as.numeric))
rownames(SEACells_peak_matrix) <- SEACells_IDs
SEACells_peak_matrix[1:2, 1:2]
dim(SEACells_peak_matrix)

# Read in metadata for all SEACells
SEACells_metadata <- fread('../output/Rshiny_input_metadata.csv')
SEACells_metadata <- SEACells_metadata %>% mutate(stage = sub(".*-", "", ATAC))
head(SEACells_metadata)

# Read in test SEACells seurat object
SEACells_seurat <- readRDS('../output/NF-downstream_analysis/Processing/ss8/SEACELLS_ATAC_WF/5_Classify_metacells/rds_files/Classified_metacells.RDS')

# # Read in peak modules
# FullData_PMs <- read.csv("../output/NF-downstream_analysis/Downstream_processing/Cluster_peaks/2_peak_clustering/PMs/FullData/unbiasedPMs.txt", header = F)
# FullData_PMs <- FullData_PMs %>% separate(V1, c("PM", "1"), sep = ";")
# dim(FullData_PMs)
# PMs <- FullData_PMs[1:5, 1:5]
# PMs_formatted <- c()
# for (i in 1:nrow(PMs)){
#   PM <- PMs[i,-1]
#   print(PM)
#   PMs_formatted <- c(PMs_formatted, PM)
# }

PPR_peaks <- c(
  "chr1-121909519-121910019", "chr1-126333347-126333847", "chr1-169475933-169476433", "chr1-34361501-34362001", "chr1-34362002-34362502", "chr1-4161134-4161634", "chr1-62211336-62211836", "chr1-79160805-79161305", "chr1-86784143-86784643", "chr1-93065551-93066051", "chr10-9146604-9147104", "chr11-6689169-6689669", "chr12-7158977-7159477", "chr18-9739470-9739970", "chr2-142451443-142451943", "chr2-50593634-50594134", "chr2-5316227-5316727", "chr2-85390201-85390701", "chr2-85765249-85765749", "chr20-7365737-7366237", "chr25-3194857-3195357", "chr25-3779484-3779984", "chr26-618206-618706", "chr28-1383546-1384046", "chr3-103855082-103855582", "chr3-37532963-37533463", "chr3-38464922-38465422", "chr3-39074445-39074945", "chr5-8048029-8048529", "chr7-22160057-22160557",
  "chr1-15030376-15030876", "chr1-16065388-16065888", "chr1-166577443-166577943", "chr1-168641905-168642405", "chr1-194840235-194840735", "chr1-39810582-39811082", "chr1-51885355-51885855", "chr10-7462858-7463358", "chr12-17501359-17501859", "chr12-18880567-18881067", "chr13-18565560-18566060", "chr14-6927832-6928332", "chr14-8672244-8672744", "chr17-8952679-8953179", "chr18-4077933-4078433", "chr2-113095334-113095834", "chr2-126301655-126302155", "chr2-142842291-142842791", "chr2-68174576-68175076", "chr2-78256853-78257353", "chr2-80039828-80040328", "chr20-10550655-10551155", "chr20-2435081-2435581", "chr20-2518293-2518793", "chr20-509873-510373", "chr20-9882128-9882628", "chr21-1425482-1425982", "chr22-1221930-1222430", "chr22-1223279-1223779", "chr22-1883318-1883818", "chr24-2230342-2230842", "chr28-2880144-2880644", "chr28-3743828-3744328", "chr3-105402084-105402584", "chr3-105848070-105848570", "chr3-109761452-109761952", "chr3-18826788-18827288", "chr3-353593-354093", "chr3-65736216-65736716", "chr3-9135619-9136119", "chr4-32359369-32359869", "chr4-82791681-82792181", "chr4-83638368-83638868", "chr7-18408127-18408627", "chr7-26273335-26273835", "chr8-20658815-20659315", "chr8-8130129-8130629",
  "chr1-105919837-105920337", "chr1-131638857-131639357", "chr1-15919402-15919902", "chr1-20918719-20919219", "chr10-5692798-5693298", "chr11-19273365-19273865", "chr12-2011549-2012049", "chr14-5259731-5260231", "chr14-5273840-5274340", "chr18-5994505-5995005", "chr19-6485088-6485588", "chr19-7913523-7914023", "chr2-113123525-113124025", "chr2-126208250-126208750", "chr2-135068586-135069086", "chr2-38837219-38837719", "chr2-46579772-46580272", "chr2-46796604-46797104", "chr2-73341546-73342046", "chr2-81301583-81302083", "chr2-87799837-87800337", "chr2-98858224-98858724", "chr20-11539936-11540436", "chr22-59038-59538", "chr23-2270591-2271091", "chr26-1704254-1704754", "chr27-4828979-4829479", "chr28-4636074-4636574", "chr3-100929473-100929973", "chr3-107043466-107043966", "chr3-11061428-11061928", "chr3-26772200-26772700", "chr3-27313048-27313548", "chr3-32517550-32518050", "chr3-40860007-40860507", "chr3-42110813-42111313", "chr3-97362357-97362857", "chr4-1390646-1391146", "chr4-176168-176668", "chr4-3545860-3546360", "chr4-38834823-38835323", "chr4-42955909-42956409", "chr4-43388891-43389391", "chr4-553198-553698", "chr4-90471528-90472028", "chr5-1148018-1148518", "chr5-14360597-14361097", "chr5-24251959-24252459", "chr5-3948608-3949108", "chr6-2060926-2061426", "chr6-3635106-3635606", "chr7-1009852-1010352", "chr7-3018116-3018616", "chr9-1192259-1192759", "chr9-18127591-18128091",
  "chr1-125858274-125858774", "chr1-147410981-147411481", "chr1-147716782-147717282", "chr1-27043376-27043876", "chr1-29823089-29823589", "chr1-34698538-34699038", "chr1-38479655-38480155", "chr10-11747024-11747524", "chr12-19545133-19545633", "chr14-3268190-3268690", "chr14-8949669-8950169", "chr18-3807814-3808314", "chr18-4329583-4330083", "chr19-2006748-2007248", "chr19-9743467-9743967", "chr2-111337271-111337771", "chr2-115496137-115496637", "chr2-126371612-126372112", "chr2-2385823-2386323", "chr2-2447021-2447521", "chr2-30026825-30027325", "chr2-4147053-4147553", "chr2-63324805-63325305", "chr3-53066212-53066712", "chr4-17695789-17696289",
  "chr1-106593929-106594429", "chr1-107351963-107352463", "chr1-115742625-115743125", "chr1-121259653-121260153", "chr1-168477153-168477653", "chr1-190355469-190355969", "chr10-13928409-13928909", "chr10-19123677-19124177", "chr11-1262663-1263163", "chr11-8925624-8926124", "chr12-9607778-9608278", "chr13-16317445-16317945", "chr13-9098943-9099443", "chr13-9668244-9668744", "chr19-9685399-9685899", "chr2-135035551-135036051", "chr2-4456308-4456808", "chr2-44731879-44732379", "chr2-4599995-4600495", "chr2-62475678-62476178", "chr2-63931517-63932017", "chr2-96625859-96626359", "chr20-1015766-1016266", "chr20-13165061-13165561", "chr20-3368975-3369475", "chr23-3914315-3914815", "chr28-416980-417480", "chr3-104089086-104089586", "chr4-39642231-39642731", "chr4-68581165-68581665", "chr5-36660229-36660729", "chr5-43715130-43715630", "chr8-11640836-11641336",
  "chr1-121260278-121260778", "chr1-157425253-157425753", "chr1-190137957-190138457", "chr1-27086986-27087486", "chr1-42364379-42364879", "chr1-50595340-50595840", "chr1-69832573-69833073", "chr1-8841329-8841829", "chr1-92667713-92668213", "chr10-20305630-20306130", "chr11-388210-388710", "chr15-2282477-2282977", "chr17-987138-987638", "chr18-10899023-10899523", "chr2-113490391-113490891", "chr2-117769270-117769770", "chr2-146588975-146589475", "chr2-20591570-20592070", "chr2-78556854-78557354", "chr2-89608377-89608877", "chr21-1003730-1004230", "chr21-394147-394647", "chr23-639645-640145", "chr24-5209934-5210434", "chr26-1071120-1071620", "chr27-3529951-3530451", "chr28-3382559-3383059", "chr3-11684665-11685165", "chr3-16112615-16113115", "chr3-34770070-34770570", "chr3-68464579-68465079", "chr3-7676617-7677117", "chr3-87379055-87379555", "chr33-4665299-4665799", "chr4-19731560-19732060", "chr4-29262570-29263070", "chr4-59717236-59717736", "chr4-61691248-61691748", "chr4-65285432-65285932", "chr4-82536788-82537288", "chr6-36126063-36126563",
  "chr1-109510633-109511133", "chr1-126378927-126379427", "chr1-29789916-29790416", "chr1-97615751-97616251", "chr10-20452537-20453037", "chr10-5260279-5260779", "chr11-2257660-2258160", "chr12-7292027-7292527", "chr13-12527823-12528323", "chr13-16386526-16387026", "chr19-8453776-8454276", "chr2-101594056-101594556", "chr2-21816243-21816743", "chr2-40666551-40667051", "chr2-62073001-62073501", "chr2-8374072-8374572", "chr2-91522834-91523334", "chr21-557708-558208", "chr23-328199-328699", "chr27-4601814-4602314", "chr27-4818770-4819270", "chr27-6164738-6165238", "chr3-103753008-103753508", "chr3-13375460-13375960", "chr3-16699856-16700356", "chr3-45266247-45266747", "chr3-50377315-50377815", "chr3-65070508-65071008", "chr3-91321007-91321507", "chr4-10134154-10134654", "chr4-33759038-33759538", "chr4-50566326-50566826", "chr4-51141722-51142222", "chr5-37774715-37775215", "chr9-8288064-8288564",
  "chr1-132707235-132707735", "chr1-172760697-172761197", "chr1-183399879-183400379", "chr1-23931466-23931966", "chr1-35416201-35416701", "chr1-43485243-43485743", "chr1-97100128-97100628", "chr11-485111-485611", "chr13-12350350-12350850", "chr13-9664712-9665212", "chr14-5549445-5549945", "chr19-6768946-6769446", "chr19-9752995-9753495", "chr2-115047514-115048014", "chr2-13036537-13037037", "chr2-15691090-15691590", "chr2-17737211-17737711", "chr2-2026716-2027216", "chr2-80457382-80457882", "chr20-765683-766183", "chr3-25705414-25705914", "chr3-90679717-90680217",
  "chr1-110281882-110282382", "chr1-113306753-113307253", "chr1-119408593-119409093", "chr1-124572961-124573461", "chr1-126605738-126606238", "chr1-131433117-131433617", "chr1-146095457-146095957", "chr1-1548751-1549251", "chr1-156920062-156920562", "chr1-15892762-15893262", "chr1-16510397-16510897", "chr1-168893830-168894330", "chr1-186493813-186494313", "chr1-20566555-20567055", "chr1-30789661-30790161", "chr1-33571364-33571864", "chr1-38326892-38327392", "chr1-39551257-39551757", "chr1-56743328-56743828", "chr1-60416481-60416981", "chr1-84352601-84353101", "chr1-86749742-86750242", "chr1-88390949-88391449", "chr1-93486724-93487224", "chr1-98741966-98742466", "chr10-10337965-10338465", "chr10-14491785-14492285", "chr10-14492580-14493080", "chr10-20340332-20340832", "chr10-7846100-7846600", "chr12-14776981-14777481", "chr12-18364771-18365271", "chr12-18943301-18943801", "chr12-18975182-18975682", "chr12-3599217-3599717", "chr12-6958745-6959245", "chr12-7163182-7163682", "chr12-8524299-8524799", "chr12-8995625-8996125", "chr13-12548521-12549021", "chr13-13513141-13513641", "chr13-1671556-1672056", "chr13-18191067-18191567", "chr13-18623581-18624081", "chr13-8986883-8987383", "chr14-13306078-13306578", "chr14-1568588-1569088", "chr14-3706879-3707379", "chr14-5769533-5770033", "chr14-7010284-7010784", "chr15-6045070-6045570", "chr15-767877-768377", "chr17-5823220-5823720", "chr17-8890725-8891225", "chr17-8979427-8979927", "chr18-836196-836696", "chr18-9597171-9597671", "chr19-8931349-8931849", "chr2-111084665-111085165", "chr2-111543253-111543753", "chr2-125108629-125109129", "chr2-126210787-126211287", "chr2-149081179-149081679", "chr2-23194456-23194956", "chr2-24093951-24094451", "chr2-28625972-28626472", "chr2-34364392-34364892", "chr2-37262664-37263164", "chr2-39091436-39091936", "chr2-40687110-40687610", "chr2-40777614-40778114", "chr2-60768678-60769178", "chr2-72766649-72767149", "chr2-74258115-74258615", "chr2-90151761-90152261", "chr2-93560478-93560978", "chr20-10297374-10297874", "chr20-3417599-3418099", "chr20-5668390-5668890", "chr20-9895339-9895839", "chr21-2402710-2403210", "chr22-1435313-1435813", "chr22-2694735-2695235", "chr23-1212726-1213226", "chr23-2493700-2494200", "chr23-3786433-3786933", "chr23-4463337-4463837", "chr25-2726380-2726880", "chr26-4786832-4787332", "chr26-4822131-4822631", "chr27-7146919-7147419", "chr3-100893435-100893935", "chr3-102692943-102693443", "chr3-108619523-108620023", "chr3-108928367-108928867", "chr3-1449127-1449627", "chr3-17341301-17341801", "chr3-22710909-22711409", "chr3-32309110-32309610", "chr3-39370694-39371194", "chr3-45793978-45794478", "chr3-64337111-64337611", "chr3-67485272-67485772", "chr3-71754992-71755492", "chr3-79368221-79368721", "chr3-87433943-87434443", "chr3-97408796-97409296", "chr4-1092590-1093090", "chr4-1166664-1167164", "chr4-17556200-17556700", "chr4-17640299-17640799", "chr4-240453-240953", "chr4-354006-354506", "chr4-37633754-37634254", "chr4-49574403-49574903", "chr4-73307921-73308421", "chr4-77824880-77825380", "chr4-9476451-9476951", "chr5-13025286-13025786", "chr5-22208723-22209223", "chr5-26331436-26331936", "chr5-32521471-32521971", "chr6-13570150-13570650", "chr6-22584965-22585465", "chr7-33112267-33112767",
  "chr1-128215833-128216333", "chr1-140680906-140681406", "chr1-154869751-154870251", "chr1-177125052-177125552", "chr1-26477151-26477651", "chr10-16877201-16877701", "chr11-3793063-3793563", "chr13-11200008-11200508", "chr13-12302020-12302520", "chr13-5027011-5027511", "chr14-5173490-5173990", "chr15-2243337-2243837", "chr17-6750892-6751392", "chr19-9283211-9283711", "chr2-115907429-115907929", "chr2-30062187-30062687", "chr2-40595415-40595915", "chr2-41399688-41400188", "chr2-44093548-44094048", "chr2-68091813-68092313", "chr2-79869348-79869848", "chr21-2705825-2706325", "chr21-3375147-3375647", "chr21-693936-694436", "chr23-5189129-5189629", "chr24-2318649-2319149", "chr26-4429645-4430145", "chr26-4542507-4543007", "chr3-15553097-15553597", "chr3-28778379-28778879", "chr3-29270621-29271121", "chr3-49878667-49879167", "chr3-56200142-56200642", "chr3-58646412-58646912", "chr3-90980485-90980985", "chr4-1738696-1739196", "chr4-23449835-23450335",
  "chr1-110825902-110826402", "chr1-116124777-116125277", "chr1-136697538-136698038", "chr1-141276478-141276978", "chr1-15015808-15016308", "chr1-157299139-157299639", "chr1-172409336-172409836", "chr1-176740306-176740806", "chr1-194742462-194742962", "chr1-196376718-196377218", "chr1-22656349-22656849", "chr1-24222888-24223388", "chr1-38366243-38366743", "chr1-42591948-42592448", "chr1-45538511-45539011", "chr1-46478536-46479036", "chr1-8065715-8066215", "chr1-80660921-80661421", "chr10-3255971-3256471", "chr10-3499070-3499570", "chr11-2074718-2075218", "chr12-19263478-19263978", "chr12-7163824-7164324", "chr13-11096560-11097060", "chr13-13545910-13546410", "chr13-9166470-9166970", "chr13-9207099-9207599", "chr14-8712329-8712829", "chr18-3734720-3735220", "chr2-115095547-115096047", "chr2-17094137-17094637", "chr2-41096965-41097465", "chr2-51531586-51532086", "chr2-64970720-64971220", "chr2-83719296-83719796", "chr2-84311085-84311585", "chr2-89602516-89603016", "chr23-2249285-2249785", "chr24-1238773-1239273", "chr3-105586636-105587136", "chr3-15861838-15862338", "chr3-16654034-16654534", "chr3-3153527-3154027", "chr3-46021620-46022120", "chr3-8650978-8651478", "chr4-15228534-15229034", "chr4-39659304-39659804", "chr5-17414692-17415192", "chr5-22235935-22236435", "chr7-14213427-14213927", "chr7-14516157-14516657"
)

shared_peaks <- c(
  "chr1-193994155-193994655", "chr1-197561547-197562047", "chr12-14410433-14410933", "chr13-1672953-1673453", "chr2-108630609-108631109", "chr2-109962400-109962900", "chr2-89175088-89175588", "chr20-10365106-10365606", "chr21-1044142-1044642", "chr28-3226790-3227290", "chr3-105971729-105972229", "chr3-40842672-40843172", "chr4-15781641-15782141", "chr4-1959409-1959909", "chr4-83396264-83396764", "chr5-21750516-21751016", "chr5-33728476-33728976", "chr5-4953807-4954307", "chr6-35973149-35973649", "chr7-7146434-7146934", "chr9-15539255-15539755",
  "chr1-65884597-65885097", "chr1-85789993-85790493", "chr1-88799677-88800177", "chr15-11693003-11693503", "chr2-32062158-32062658", "chr3-109916613-109917113", "chr3-91418181-91418681", "chr4-12619653-12620153", "chr4-15606600-15607100", "chr5-24680400-24680900", "chr5-45207022-45207522", "chr7-16951932-16952432", "chr7-22637794-22638294", "chr7-25627716-25628216", "chr8-6215467-6215967", "chr9-13618140-13618640", "chr9-17038825-17039325", "chr9-6333690-6334190",
  "chr1-110335965-110336465", "chr1-154056799-154057299", "chr1-177406038-177406538", "chr1-66866-67366", "chr1-78182592-78183092", "chr1-92932-93432", "chr10-7462101-7462601", "chr12-10162547-10163047", "chr12-19504559-19505059", "chr15-12839851-12840351", "chr17-8408784-8409284", "chr18-1600943-1601443", "chr19-8482522-8483022", "chr2-109669210-109669710", "chr2-114269644-114270144", "chr2-21543656-21544156", "chr2-33551271-33551771", "chr2-44147601-44148101", "chr2-8834638-8835138", "chr2-90514060-90514560", "chr20-8578971-8579471", "chr21-1022899-1023399", "chr21-3042775-3043275", "chr22-1808593-1809093", "chr26-1965406-1965906", "chr26-3209598-3210098", "chr3-103311085-103311585", "chr3-11161134-11161634", "chr3-51455828-51456328", "chr3-9604325-9604825", "chr4-11662831-11663331", "chr4-58169920-58170420", "chr4-65422232-65422732", "chr4-88734002-88734502", "chr5-14558865-14559365", "chr5-25146553-25147053", "chr6-2685776-2686276", "chr8-5202586-5203086",
  "chr1-109356532-109357032", "chr1-113784394-113784894", "chr1-117188382-117188882", "chr1-124459850-124460350", "chr1-25342104-25342604", "chr1-60970364-60970864", "chr1-61692478-61692978", "chr1-66488042-66488542", "chr10-13705436-13705936", "chr10-17243415-17243915", "chr11-15521598-15522098", "chr11-15529701-15530201", "chr11-16020874-16021374", "chr13-1626055-1626555", "chr14-6328540-6329040", "chr14-8599535-8600035", "chr15-2210316-2210816", "chr17-4144523-4145023", "chr17-7661138-7661638", "chr18-1055291-1055791", "chr19-8281446-8281946", "chr2-136767281-136767781", "chr2-141576281-141576781", "chr2-147786771-147787271", "chr2-5706439-5706939", "chr2-78063433-78063933", "chr22-1549602-1550102", "chr28-2142363-2142863", "chr3-101800822-101801322", "chr3-108232358-108232858", "chr3-43238308-43238808", "chr33-4973016-4973516", "chr33-6568632-6569132", "chr4-44150493-44150993", "chr4-44243806-44244306", "chr4-70700910-70701410", "chr5-14507069-14507569", "chr5-38472076-38472576", "chr7-9765533-9766033", "chr8-20919981-20920481", "chr8-21682345-21682845", "chr9-12061796-12062296",
  "chr1-12977557-12978057", "chr1-169474904-169475404", "chr1-8746199-8746699", "chr10-3312015-3312515", "chr13-4435597-4436097", "chr13-5486272-5486772", "chr17-8061757-8062257", "chr2-11833060-11833560", "chr2-122768242-122768742", "chr2-35931150-35931650", "chr20-10281103-10281603", "chr21-6458307-6458807", "chr24-591035-591535", "chr28-706491-706991", "chr3-105969595-105970095", "chr3-19529452-19529952", "chr3-25129510-25130010", "chr3-61332188-61332688", "chr3-80775115-80775615", "chr3-9906528-9907028", "chr4-34523338-34523838", "chr4-34644939-34645439", "chr4-63189789-63190289", "chr5-38049804-38050304", "chr6-26679709-26680209", "chr6-28736936-28737436", "chr6-28738896-28739396",
  "chr1-112005934-112006434", "chr1-119613992-119614492", "chr1-126460587-126461087", "chr1-136705131-136705631", "chr1-13826107-13826607", "chr1-168839303-168839803", "chr1-173971901-173972401", "chr1-20793858-20794358", "chr1-24962584-24963084", "chr1-45123789-45124289", "chr1-60366404-60366904", "chr1-67947194-67947694", "chr1-8745671-8746171", "chr1-88807407-88807907", "chr10-14588500-14589000", "chr14-8460804-8461304", "chr17-2857405-2857905", "chr18-2289523-2290023", "chr2-13303067-13303567", "chr2-18757803-18758303", "chr2-23699927-23700427", "chr2-40163142-40163642", "chr2-64488201-64488701", "chr2-82798711-82799211", "chr21-6316545-6317045", "chr24-3111272-3111772", "chr27-4589973-4590473", "chr3-109769119-109769619", "chr4-50663077-50663577", "chr4-54188827-54189327", "chr4-74236441-74236941", "chr5-13181203-13181703", "chr5-22238626-22239126", "chr5-25039278-25039778", "chr6-20498077-20498577", "chr6-24642288-24642788", "chr7-22624406-22624906", "chr8-16705386-16705886"
)

# Read in peaks found from HiChip
PPR_hichip_peaks <- read.csv(("../output/Rshiny_PPR_input_peaks.csv"))
PPR_hichip_peaks <- PPR_hichip_peaks$x
NC_hichip_peaks <- read.csv(("../output/Rshiny_NC_input_peaks.csv"))
NC_hichip_peaks <- NC_hichip_peaks$x

############################################################################
##################       Read in aesthetic params      #####################

scHelper_cell_type_order <- c('node', 'streak', 'PGC', 'BI', 'meso', 'endo',
                              'EE', 'NNE', 'pEpi', 'PPR', 'aPPR', 'pPPR',
                              'eNPB', 'NPB', 'aNPB', 'pNPB','NC', 'dNC',
                              'eN', 'eCN', 'NP', 'pNP', 'HB', 'iNP', 'MB', 
                              'aNP', 'FB', 'vFB', 'Unmapped')

scHelper_cell_type_colours <- c("#ed5e5f", "#A73C52", "#6B5F88", "#3780B3", "#3F918C", "#47A266", "#53A651", "#6D8470",
                                "#87638F", "#A5548D", "#C96555", "#ED761C", "#FF9508", "#FFC11A", "#FFEE2C", "#EBDA30",
                                "#CC9F2C", "#AD6428", "#BB614F", "#D77083", "#F37FB8", "#DA88B3", "#B990A6", "#b3b3b3",
                                "#786D73", "#581845", "#9792A3", "#BBB3CB", "#EAEAEA")

names(scHelper_cell_type_colours) <- c('NNE', 'HB', 'eNPB', 'PPR', 'aPPR', 'streak',
                                       'pPPR', 'NPB', 'aNPB', 'pNPB','eCN', 'dNC',
                                       'eN', 'NC', 'NP', 'pNP', 'EE', 'iNP', 'MB', 
                                       'vFB', 'aNP', 'node', 'FB', 'pEpi',
                                       'PGC', 'BI', 'meso', 'endo', 'Unmapped')
stage_colours = c("#8DA0CB", "#66C2A5", "#A6D854", "#FFD92F", "#FC8D62")
stage_order <- c("HH5", "HH6", "HH7", "ss4", "ss8")
names(stage_colours) <- stage_order

my_theme <- theme(axis.text=element_text(size=14),
                  axis.title=element_text(size=16))

############################################################################
####################       Read in UI options      ##########################

# Potential ways to subset the SEACells matrix to make heatmaps
data_subsets = c("Full Data", "HH5", "HH6", "HH7", "ss4", "ss8")

# Potential ways to group UMAP
dimplot_groupby_options = c("seurat_clusters", "scHelper_cell_type")

